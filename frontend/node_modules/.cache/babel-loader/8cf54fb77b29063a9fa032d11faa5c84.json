{"remainingRequest":"/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/babel-loader/lib/index.js!/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/src/components/Posts.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/src/components/Posts.vue","mtime":1621890085819},{"path":"/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/testtest/Desktop/a trier/P7-Groupomania/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCBDcmVhdGVQb3N0IGZyb20gJy4vQ3JlYXRlUG9zdCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAncG9zdHMnLAogIGNvbXBvbmVudHM6IHsKICAgIENyZWF0ZVBvc3Q6IENyZWF0ZVBvc3QKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBwb3N0czogW10sCiAgICAgIGxpa2VzOiBudWxsLAogICAgICB1c2VySWQ6IG51bGwsCiAgICAgIGlzYWRtaW46IDAsCiAgICAgIGVycm9yOiAnJywKICAgICAgYWRtaW5EbHRSb3V0ZTogJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvYWRtaW4vJywKICAgICAgdXNlckRsdFJvdXRlOiAnaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9wb3N0LycsCiAgICAgIHRva2VuOiAnJwogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICBjb25zb2xlLmxvZygnY3JlYXRlZCcpOwogICAgdGhpcy50b2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgdGhpcy51c2VySWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcklkJyk7CiAgICB0aGlzLmlzYWRtaW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnaXNhZG1pbicpOwogICAgdGhpcy5nZXRQb3N0cygpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0UG9zdHM6IGZ1bmN0aW9uIGdldFBvc3RzKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgLy9lbnZveWVyIHVuZSByZXF1w6p0ZSBwb3VyIHLDqWN1cMOpcmVyIGxlcyBwb3N0cyBhdmVjIGxlIGJlYXJlciB0b2tlbgogICAgICBmZXRjaCgiaHR0cDovL2xvY2FsaG9zdDozMDAwL2FwaS9wb3N0L2dldFBvc3RzIiwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGF1dGhvcml6YXRpb246ICdCZWFyZXIgJyArIHRoaXMudG9rZW4KICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDMpIHsKICAgICAgICAgIGFsZXJ0KCJWb3VzIMOqdGVzIGNvbm5lY3TDqSBkZXB1aXMgcGx1cyBkZSA4IGhldXJlcywgdm91cyBkZXZleiB2b3VzIHJlY29ubmVjdGVyIik7CiAgICAgICAgfQoKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmpzb24oKTsKICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGNvbnNvbGUubG9nKGRhdGEpOwogICAgICAgIF90aGlzLnBvc3RzID0gZGF0YTsKICAgICAgfSk7CiAgICB9LAogICAgZGVsZXRlUG9zdDogZnVuY3Rpb24gZGVsZXRlUG9zdChpZCwgdXJsKSB7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMudG9rZW4gKyAnZGVsZXRlcG9zdCcpOwogICAgICBmZXRjaCh1cmwgKyBpZCwgewogICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgYXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgdGhpcy50b2tlbgogICAgICAgIH0KICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgcmV0dXJuIHJlczsKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gNDAxKSB7CiAgICAgICAgICBhbGVydCgnVm91cyBuZSBwb3V2ZXogcGFzIHN1cHByaW1lciBjZSBwb3N0Jyk7CiAgICAgICAgfQoKICAgICAgICBpZiAocmVzLnN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgbGlrZVBvc3Q6IGZ1bmN0aW9uIGxpa2VQb3N0KGlkKSB7CiAgICAgIHZhciB1c2VySWQgPSB0aGlzLnVzZXJJZDsKICAgICAgY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkodXNlcklkKSk7CiAgICAgIGZldGNoKCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3Bvc3QvIi5jb25jYXQoaWQsICIvbGlrZSIpLCB7CiAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgdXNlcklkOiB1c2VySWQsCiAgICAgICAgICBsaWtlOiAxCiAgICAgICAgfSksCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgYXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgdGhpcy50b2tlbiwKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhyZXMpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZXR1cm4gY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0sCiAgICBkaXNMaWtlUG9zdDogZnVuY3Rpb24gZGlzTGlrZVBvc3QoaWQpIHsKICAgICAgdmFyIHVzZXJJZCA9IHRoaXMudXNlcklkOwogICAgICBjb25zb2xlLmxvZyhKU09OLnN0cmluZ2lmeSh1c2VySWQpKTsKICAgICAgZmV0Y2goImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvcG9zdC8iLmNvbmNhdChpZCwgIi9saWtlIiksIHsKICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICB1c2VySWQ6IHVzZXJJZCwKICAgICAgICAgIGxpa2U6IC0xCiAgICAgICAgfSksCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgYXV0aG9yaXphdGlvbjogJ0JlYXJlciAnICsgdGhpcy50b2tlbiwKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIHJldHVybiBjb25zb2xlLmxvZyhyZXMpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZXR1cm4gY29uc29sZS5sb2coZXJyb3IpOwogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["Posts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA,OAAA,UAAA,MAAA,cAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,OADA;AAEA,EAAA,UAAA,EAAA;AACA,IAAA,UAAA,EAAA;AADA,GAFA;AAKA,EAAA,IALA,kBAKA;AACA,WAAA;AACA,MAAA,KAAA,EAAA,EADA;AAEA,MAAA,KAAA,EAAA,IAFA;AAGA,MAAA,MAAA,EAAA,IAHA;AAIA,MAAA,OAAA,EAAA,CAJA;AAKA,MAAA,KAAA,EAAA,EALA;AAMA,MAAA,aAAA,EAAA,kCANA;AAOA,MAAA,YAAA,EAAA,iCAPA;AAQA,MAAA,KAAA,EAAA;AARA,KAAA;AAUA,GAhBA;AAiBA,EAAA,OAjBA,qBAiBA;AACA,IAAA,OAAA,CAAA,GAAA,CAAA,SAAA;AACA,SAAA,KAAA,GAAA,YAAA,CAAA,OAAA,CAAA,OAAA,CAAA;AACA,SAAA,MAAA,GAAA,YAAA,CAAA,OAAA,CAAA,QAAA,CAAA;AACA,SAAA,OAAA,GAAA,YAAA,CAAA,OAAA,CAAA,SAAA,CAAA;AACA,SAAA,QAAA;AACA,GAvBA;AAwBA,EAAA,OAAA,EAAA;AACA,IAAA,QADA,sBACA;AAAA;;AACA;AACA,MAAA,KAAA,CAAA,yCAAA,EACA;AACA,QAAA,OAAA,EACA;AACA,UAAA,aAAA,EAAA,YAAA,KAAA;AADA;AAFA,OADA,CAAA,CAMA,IANA,CAMA,UAAA,QAAA,EAAA;AACA,YAAA,QAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,UAAA,KAAA,CAAA,yEAAA,CAAA;AACA;;AACA,YAAA,IAAA,GAAA,QAAA,CAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,eAAA,IAAA;AACA,OAbA,EAaA,IAbA,CAaA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,IAAA;AACA,QAAA,KAAA,CAAA,KAAA,GAAA,IAAA;AACA,OAhBA;AAkBA,KArBA;AAsBA,IAAA,UAtBA,sBAsBA,EAtBA,EAsBA,GAtBA,EAsBA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,KAAA,GAAA,YAAA;AACA,MAAA,KAAA,CAAA,GAAA,GAAA,EAAA,EAAA;AACA,QAAA,MAAA,EAAA,QADA;AAEA,QAAA,OAAA,EAAA;AACA,UAAA,aAAA,EAAA,YAAA,KAAA;AADA;AAFA,OAAA,CAAA,CAKA,IALA,CAKA,UAAA,GAAA,EAAA;AACA,eAAA,GAAA;AACA,OAPA,EAOA,IAPA,CAOA,UAAA,GAAA,EAAA;AACA,YAAA,GAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,UAAA,KAAA,CAAA,sCAAA,CAAA;AACA;;AACA,YAAA,GAAA,CAAA,MAAA,IAAA,GAAA,EAAA;AACA,UAAA,QAAA,CAAA,QAAA,CAAA,MAAA;AACA;AACA,OAdA;AAeA,KAvCA;AAwCA,IAAA,QAxCA,oBAwCA,EAxCA,EAwCA;AACA,UAAA,MAAA,GAAA,KAAA,MAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA,CAAA,SAAA,CAAA,MAAA,CAAA;AACA,MAAA,KAAA,0CAAA,EAAA,YAAA;AACA,QAAA,MAAA,EAAA,MADA;AAEA,QAAA,IAAA,EAAA,IAAA,CAAA,SAAA,CAAA;AACA,UAAA,MAAA,EAAA,MADA;AAEA,UAAA,IAAA,EAAA;AAFA,SAAA,CAFA;AAMA,QAAA,OAAA,EAAA;AACA,UAAA,aAAA,EAAA,YAAA,KAAA,KADA;AAEA,0BAAA;AAFA;AANA,OAAA,CAAA,CAUA,IAVA,CAUA,UAAA,GAAA;AAAA,eAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA;AAAA,OAVA,WAWA,UAAA,KAAA;AAAA,eAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA;AAAA,OAXA;AAYA,KAvDA;AAwDA,IAAA,WAxDA,uBAwDA,EAxDA,EAwDA;AACA,UAAA,MAAA,GAAA,KAAA,MAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA,CAAA,SAAA,CAAA,MAAA,CAAA;AACA,MAAA,KAAA,0CAAA,EAAA,YAAA;AACA,QAAA,MAAA,EAAA,MADA;AAEA,QAAA,IAAA,EAAA,IAAA,CAAA,SAAA,CAAA;AACA,UAAA,MAAA,EAAA,MADA;AAEA,UAAA,IAAA,EAAA,CAAA;AAFA,SAAA,CAFA;AAMA,QAAA,OAAA,EAAA;AACA,UAAA,aAAA,EAAA,YAAA,KAAA,KADA;AAEA,0BAAA;AAFA;AANA,OAAA,CAAA,CAUA,IAVA,CAUA,UAAA,GAAA;AAAA,eAAA,OAAA,CAAA,GAAA,CAAA,GAAA,CAAA;AAAA,OAVA,WAWA,UAAA,KAAA;AAAA,eAAA,OAAA,CAAA,GAAA,CAAA,KAAA,CAAA;AAAA,OAXA;AAYA;AAvEA;AAxBA,CAAA","sourcesContent":["<template>\n    <div id=\"container\">\n        <div id=\"posts\">\n            <div id=\"postsContainer\">\n                <div class=\"card\">\n                    <CreatePost @postsent=\"getPosts\"/>\n                </div>\n                <div v-if=\"posts==''\" id=\"emptyPosts\">\n                    <p>Pas encore de post</p>\n                </div>\n                <div v-for=\"post in posts\" :key=\"post.post_id\" class=\"card\">\n                        <div id=\"head\"><p>{{post.firstName}} {{post.lastName}} a écrit :</p></div>\n                        <router-link :to=\"{name: 'post', params: {id: post.post_id}}\">\n                            <div id=\"body\"><p>{{post.comment}}</p></div>\n                            <div v-if=\"post.imageurl\">\n                                <img :src=\"post.imageurl\" alt=\"image du post\">\n                            </div>\n                        </router-link>\n                        <div class=\"btns\">\n                            <button v-if=\"userId == post.id\" @click=\"deletePost(post.post_id, userDltRoute)\" class=\"deleteBtn btn\"><i class=\"fas fa-trash-alt\"></i></button>\n                            <button v-if=\"isadmin == 1\" @click=\"deletePost(post.post_id, adminDltRoute)\" class=\"adminDelete btn\">Modérer ce post</button>\n                            <button class=\"btnLike btn\" id=\"like\" @click=\"likePost(post.post_id)\"><i class=\"fas fa-thumbs-up\" v-if=\"post.userReaction == 1\"></i><i class=\"far fa-thumbs-up\" v-else></i>{{post.likes}}</button>\n                            <button class=\"btnLike btn\" id=\"disLike\" @click=\"disLikePost(post.post_id)\"><i class=\"fas fa-thumbs-down\" v-if=\"post.userReaction == -1\"></i><i class=\"far fa-thumbs-down\" v-else></i>{{post.disLikes}}</button>\n                        </div>\n                </div>\n            </div> \n        </div>\n    </div>\n</template>\n\n<script>\nimport CreatePost from './CreatePost';\nexport default {\n    name: 'posts',\n    components: {\n        CreatePost: CreatePost\n    },\n    data(){\n        return{\n            posts: [],\n            likes: null,\n            userId: null,\n            isadmin: 0,\n            error: '',\n            adminDltRoute: 'http://localhost:3000/api/admin/',\n            userDltRoute: 'http://localhost:3000/api/post/',\n            token: ''\n        }\n    },\n    created(){\n        console.log('created')\n        this.token = localStorage.getItem('token');\n        this.userId = localStorage.getItem('userId');\n        this.isadmin = localStorage.getItem('isadmin');\n        this.getPosts();       \n    },\n    methods: {\n        getPosts() {\n            //envoyer une requête pour récupérer les posts avec le bearer token\n            fetch(\"http://localhost:3000/api/post/getPosts\",\n            {\n                headers: \n                {\n                    authorization : 'Bearer ' + this.token\n                }\n            }).then(response => {\n                if(response.status == 403){\n                    alert(\"Vous êtes connecté depuis plus de 8 heures, vous devez vous reconnecter\")\n                }\n                const data = response.json();\n                console.log(data)\n                return data\n            }).then(data => {\n                console.log(data);\n                this.posts = data\n            })\n            \n        },\n        deletePost(id, url) {\n            console.log(this.token+'deletepost');\n            fetch(url + id, {\n                method: 'delete',\n                headers: {\n                    authorization : 'Bearer ' + this.token\n                }\n            }).then(res => {\n                return res\n            }).then(res => {\n                if (res.status == 401){\n                    alert('Vous ne pouvez pas supprimer ce post')\n                }\n                if(res.status == 200){\n                document.location.reload();\n                }\n            })\n        },\n        likePost(id) {\n            const userId = this.userId\n            console.log(JSON.stringify(userId))\n            fetch(`http://localhost:3000/api/post/${id}/like`,{\n                method: 'POST',\n                body: JSON.stringify({\n                    userId: userId,\n                    like: 1\n                    }),\n                headers: {\n                    authorization : 'Bearer ' + this.token,\n                    'Content-Type' : 'application/json',\n                },\n            }).then(res => console.log(res))\n            .catch(error => console.log(error))\n        },\n        disLikePost(id) {\n            const userId = this.userId\n            console.log(JSON.stringify(userId))\n            fetch(`http://localhost:3000/api/post/${id}/like`,{\n                method: 'POST',\n                body: JSON.stringify({\n                    userId: userId,\n                    like: -1\n                    }),\n                headers: {\n                    authorization : 'Bearer ' + this.token,\n                    'Content-Type' : 'application/json',\n                },\n            }).then(res => console.log(res))\n            .catch(error => console.log(error))\n        }\n    }\n}\n</script>\n<style lang=\"scss\" scoped>\n@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200&display=swap');\n#titleForum{\n    width: 40%;\n    margin-left: auto;\n    margin-right: auto;\n}\na{\n    text-decoration: none;\n    color: black;\n}\nh1{\n    font-family: 'Poppins';\n}\n\n#postsContainer{\n    width: 40%;\n    margin-right: auto;\n    margin-left: auto;\n}\n#emptyPosts{\n    text-align: center;\n    margin-top: 20vh;\n}\n#container{\n    width: 100%;\n}\n\n.card{\n    padding: 1rem;\n    background-color: white;\n    box-shadow: 0px 0px 10px rgb(110, 107, 107);\n    margin-top: 20px;\n    border-radius: 1rem;\n    img{\n        max-height: 50%;\n        max-width: 100%;\n    }\n}\n#head, #body{\n    text-align: start;\n}\n\n#head{\n    font-family: franklin Gothic, Arial Bold\n}\n.btns{\n    display: flex;\n}\n.adminDelete{\n    background-color:crimson;\n    color: whitesmoke;\n}\n.deleteBtn{\n    width: fit-content;\n}\n.btnLike{\n    width: fit-content;\n    background-color: none;\n}\n\n//responsive\n@media screen and (min-width: 200px) and (max-width: 900px) {\n    #postsContainer{\n        width: 90%;\n    }\n    .card{\n        border-radius: 0;\n    }\n}\n</style>"],"sourceRoot":"src/components"}]}